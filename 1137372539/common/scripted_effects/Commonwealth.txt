#	Example:
# 
#	example_effect = {
#		add_political_power = 66
#		add_popularity = {
#			ideology = fascism
#			popularity = 0.33
#		}
#	}
#
#
#	In a script file:
#
#	effect = {
#		example_effect = yes
#	}
#
	
## Order is important
depression_improves = {
	if = {
		limit = {
			has_idea = CW_great_depression_0
		}
		swap_ideas = {
			remove_idea = CW_great_depression_0
			add_idea = CW_great_depression_1
		}
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_1
		}
		swap_ideas = {
			remove_idea = CW_great_depression_1
			add_idea = CW_great_depression_2
		}
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_2
		}
		swap_ideas = {
			remove_idea = CW_great_depression_2
			add_idea = CW_great_depression_3
		}		
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_3
		}
		swap_ideas = {
			remove_idea = CW_great_depression_3
			add_idea = CW_great_depression_4
		}		
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_4
		}
		swap_ideas = {
			remove_idea = CW_great_depression_4
			add_idea = CW_great_depression_5
		}		
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_5
		}
		swap_ideas = {
			remove_idea = CW_great_depression_5
			add_idea = CW_great_depression_6
		}		
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_6
		}
		remove_ideas = CW_great_depression_6
	}
}
depression_ends = {
	if = {
		limit = {
			has_idea = CW_great_depression_1
		}
		remove_ideas = CW_great_depression_1
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_2
		}
		remove_ideas = CW_great_depression_2		
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_3
		}
		remove_ideas = CW_great_depression_3		
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_4
		}
		remove_ideas = CW_great_depression_4		
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_5
		}
		remove_ideas = CW_great_depression_5		
	}
	else_if = {
		limit = {
			has_idea = CW_great_depression_6
		}
		remove_ideas = CW_great_depression_6
	}
}
more_conservatism_drift = {
	if = {
		limit = {
			has_idea = major_conservatism_drift
		}
		add_popularity = {
			ideology = conservatism
			popularity = 0.05	
		}
	}
	else_if = {
		limit = {
			has_idea = large_conservatism_drift
		}
		swap_ideas = {
			remove_idea = large_conservatism_drift
			add_idea = major_conservatism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = regular_conservatism_drift
		}
		swap_ideas = {
			remove_idea = regular_conservatism_drift
			add_idea = large_conservatism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = small_conservatism_drift
		}
		swap_ideas = {
			remove_idea = small_conservatism_drift
			add_idea = regular_conservatism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = mini_conservatism_drift
		}
		swap_ideas = {
			remove_idea = mini_conservatism_drift
			add_idea = small_conservatism_drift
		}
	}
	else = {
		add_ideas = mini_conservatism_drift
	}
}
less_conservatism_drift = {
	if = {
		limit = {
			has_idea = mini_conservatism_drift
		}
		remove_ideas = mini_conservatism_drift
	}
	else_if = {
		limit = {
			has_idea = small_conservatism_drift
		}	
		swap_ideas = {
			remove_idea = small_conservatism_drift
			add_idea = mini_conservatism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = regular_conservatism_drift
		}
		swap_ideas = {
			add_idea = small_conservatism_drift
			remove_idea = regular_conservatism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = large_conservatism_drift
		}
		swap_ideas = {
			remove_idea = large_conservatism_drift
			add_idea = regular_conservatism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = major_conservatism_drift
		}
		swap_ideas = {
			remove_idea = major_conservatism_drift
			add_idea = large_conservatism_drift
		}
	}
	else = {
		add_popularity = {
			ideology = conservatism
			popularity = -0.03	
		}
	}
}

more_liberalism_drift = {
	if = {
		limit = {
			has_idea = major_liberalism_drift
		}
		add_popularity = {
			ideology = liberalism
			popularity = 0.05	
		}
	}
	else_if = {
		limit = {
			has_idea = large_liberalism_drift
		}
		swap_ideas = {
			remove_idea = large_liberalism_drift
			add_idea = major_liberalism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = regular_liberalism_drift
		}
		swap_ideas = {
			remove_idea = regular_liberalism_drift
			add_idea = large_liberalism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = small_liberalism_drift
		}
		swap_ideas = {
			remove_idea = small_liberalism_drift
			add_idea = regular_liberalism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = mini_liberalism_drift
		}
		swap_ideas = {
			remove_idea = mini_liberalism_drift
			add_idea = small_liberalism_drift
		}
	}
	else = {
		add_ideas = mini_liberalism_drift
	}
}
less_liberalism_drift = {
	if = {
		limit = {
			has_idea = mini_liberalism_drift
		}
		remove_ideas = mini_liberalism_drift
	}
	else_if = {
		limit = {
			has_idea = small_liberalism_drift
		}	
		swap_ideas = {
			remove_idea = small_liberalism_drift
			add_idea = mini_liberalism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = regular_liberalism_drift
		}
		swap_ideas = {
			add_idea = small_liberalism_drift
			remove_idea = regular_liberalism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = large_liberalism_drift
		}
		swap_ideas = {
			remove_idea = large_liberalism_drift
			add_idea = regular_liberalism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = major_liberalism_drift
		}
		swap_ideas = {
			remove_idea = major_liberalism_drift
			add_idea = large_liberalism_drift
		}
	}
	else = {
		add_popularity = {
			ideology = liberalism
			popularity = -0.03	
		}
	}
}	
more_socialism_drift = {
	if = {
		limit = {
			has_idea = major_socialism_drift
		}
		add_popularity = {
			ideology = socialism
			popularity = 0.05	
		}
	}
	else_if = {
		limit = {
			has_idea = large_socialism_drift
		}
		swap_ideas = {
			remove_idea = large_socialism_drift
			add_idea = major_socialism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = regular_socialism_drift
		}
		swap_ideas = {
			remove_idea = regular_socialism_drift
			add_idea = large_socialism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = small_socialism_drift
		}
		swap_ideas = {
			remove_idea = small_socialism_drift
			add_idea = regular_socialism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = mini_socialism_drift
		}
		swap_ideas = {
			remove_idea = mini_socialism_drift
			add_idea = small_socialism_drift
		}
	}
	else = {
		add_ideas = mini_socialism_drift
	}
}
less_socialism_drift = {
	if = {
		limit = {
			has_idea = mini_socialism_drift
		}
		remove_ideas = mini_socialism_drift
	}
	else_if = {
		limit = {
			has_idea = small_socialism_drift
		}	
		swap_ideas = {
			remove_idea = small_socialism_drift
			add_idea = mini_socialism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = regular_socialism_drift
		}
		swap_ideas = {
			add_idea = small_socialism_drift
			remove_idea = regular_socialism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = large_socialism_drift
		}
		swap_ideas = {
			remove_idea = large_socialism_drift
			add_idea = regular_socialism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = major_socialism_drift
		}
		swap_ideas = {
			remove_idea = major_socialism_drift
			add_idea = large_socialism_drift
		}
	}
	else = {
		add_popularity = {
			ideology = socialism
			popularity = -0.03	
		}
	}
}
more_agrarianism_drift = {
	if = {
		limit = {
			has_idea = major_agrarianism_drift
		}
		add_popularity = {
			ideology = agrarianism
			popularity = 0.05	
		}
	}
	else_if = {
		limit = {
			has_idea = large_agrarianism_drift
		}
		swap_ideas = {
			remove_idea = large_agrarianism_drift
			add_idea = major_agrarianism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = regular_agrarianism_drift
		}
		swap_ideas = {
			remove_idea = regular_agrarianism_drift
			add_idea = large_agrarianism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = small_agrarianism_drift
		}
		swap_ideas = {
			remove_idea = small_agrarianism_drift
			add_idea = regular_agrarianism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = mini_agrarianism_drift
		}
		swap_ideas = {
			remove_idea = mini_agrarianism_drift
			add_idea = small_agrarianism_drift
		}
	}
	else = {
		add_ideas = mini_agrarianism_drift
	}
}
less_agrarianism_drift = {
	if = {
		limit = {
			has_idea = mini_agrarianism_drift
		}
		remove_ideas = mini_agrarianism_drift
	}
	else_if = {
		limit = {
			has_idea = small_agrarianism_drift
		}	
		swap_ideas = {
			remove_idea = small_agrarianism_drift
			add_idea = mini_agrarianism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = regular_agrarianism_drift
		}
		swap_ideas = {
			add_idea = small_agrarianism_drift
			remove_idea = regular_agrarianism_drift
		}
	}
	else_if = {
		limit = {
			has_idea = large_agrarianism_drift
		}
		swap_ideas = {
			remove_idea = large_agrarianism_drift
			add_idea = regular_agrarianism_drift
		}
	}	
	else_if = {
		limit = {
			has_idea = major_agrarianism_drift
		}
		swap_ideas = {
			remove_idea = major_agrarianism_drift
			add_idea = large_agrarianism_drift
		}
	}
	else = {
		add_popularity = {
			ideology = agrarianism
			popularity = -0.03	
		}
	}
}
AST_womens_military_presence = {		
	if = {
		limit = {
			has_idea = AST_womens_military_presence_1
		}
		swap_ideas = {
			remove_idea = AST_womens_military_presence_1
			add_idea = AST_womens_military_presence_2
		}
	}
	else_if = {
		limit = {
			has_idea = AST_womens_military_presence_2
		}
		swap_ideas = {
			remove_idea = AST_womens_military_presence_2
			add_idea = AST_womens_military_presence_3
		}
	}
	else_if = {
		limit = {
			has_idea = AST_womens_military_presence_3
		}
		swap_ideas = {
			remove_idea = AST_womens_military_presence_3
			add_idea = AST_womens_military_presence_4
		}
	}
	else_if = {
		limit = {
			has_idea = AST_womens_military_presence_4
		}
		swap_ideas = {
			remove_idea = AST_womens_military_presence_4
			add_idea = AST_womens_military_presence_5
		}
	}
}
maud_improve = {
	set_temp_variable = { change_to = ENG_maud_research }
	add_to_temp_variable = { change_to = maud_improve?1 }
	
	if = {
		limit = {
			check_variable = { change_to > token:ENG_maud_research1 }
		}
		remove_ideas = var:ENG_maud_research
		clear_variable = ENG_maud_research
	}
	else_if = {
		limit = {
			has_variable = ENG_maud_research
		}
		
		swap_ideas = {
			remove_idea = var:ENG_maud_research
			add_idea = var:change_to
		}
		set_variable = { ENG_maud_research = change_to }
	}
	else = {
		set_temp_variable = { ENG_maud_research = token:ENG_maud_research50 }
		
		set_temp_variable = { change_to = ENG_maud_research }
		add_to_temp_variable = { change_to = maud_improve?1 }
		effect_tooltip = {
			swap_ideas = {
				remove_idea = var:ENG_maud_research
				add_idea = var:change_to
			}
		}
	}
	
	set_temp_variable = { maud_improve = 1 }
}
maud_add2 = {
	set_temp_variable = { maud_improve = 2 }
	maud_improve = yes
}
maud_add3 = {
	set_temp_variable = { maud_improve = 3 }
	maud_improve = yes
}
maud_add4 = {
	set_temp_variable = { maud_improve = 4 }
	maud_improve = yes
}
maud_add5 = {
	set_temp_variable = { maud_improve = 5 }
	maud_improve = yes
}
maud_add6 = {
	set_temp_variable = { maud_improve = 6 }
	maud_improve = yes
}
air_plan_production_update = {
	set_variable = { trainer_air_cost = trainer_production }
	multiply_variable = { trainer_air_cost = 3 }
	set_variable = { country_resource_cost_aluminium = trainer_production }
	multiply_variable = { country_resource_cost_aluminium = 2 }
	set_variable = { train_planes = trainer_production }
	if = {
		limit = {
			has_completed_focus = CW_moth
		}
		multiply_variable = { train_planes = 1.25 }
	}
	if = {
		limit = {
			has_completed_focus = ENG_Reid
		}
		multiply_variable = { train_planes = 1.05 }
	}
	if = {
		limit = {
			has_tech = air_infra5
		}
		multiply_variable = { train_planes = 1.25 }
	}
	else_if = {
		limit = {
			has_tech = air_infra4
		}
		multiply_variable = { train_planes = 1.2 }
	}	
	else_if = {
		limit = {
			has_tech = air_infra3
		}
		multiply_variable = { train_planes = 1.15 }
	}
	else_if = {
		limit = {
			has_tech = air_infra2
		}
		multiply_variable = { train_planes = 1.1 }
	}
	else_if = {
		limit = {
			has_tech = air_infra
		}
		multiply_variable = { train_planes = 1.05 }
	}
}
air_plan_training_aircraft_update = {
	
	add_to_variable = { ENG.trainers_available = ENG.train_planes tooltip = CW_PLAN_from_ENG }
	
	## Commonwealth participation
	
	if = {
		limit = {
			CAN = { has_country_flag = CW_THE_PLAN }
		}
		add_to_variable = { ENG.trainers_available = CAN.train_planes tooltip = CW_PLAN_from_CAN }
	}
	if = {
		limit = {
			AST = { has_country_flag = CW_THE_PLAN }
		}
		add_to_variable = { ENG.trainers_available = AST.train_planes tooltip = CW_PLAN_from_AST }
	}
	if = {
		limit = {
			NZL = { has_country_flag = CW_THE_PLAN }
		}
		add_to_variable = { ENG.trainers_available = NZL.train_planes tooltip = CW_PLAN_from_NZL }
	}
	if = {
		limit = {
			SAF = { has_country_flag = CW_THE_PLAN }
		}
		add_to_variable = { ENG.trainers_available = SAF.train_planes tooltip = CW_PLAN_from_SAF }
	}
	if = {
		limit = {
			USA = { 
				has_country_flag = pilots_sent 
				has_country_flag = send_trainers
			}
		}
		add_to_variable = { ENG.trainers_available = USA.train_planes tooltip = CW_PLAN_from_USA }
	}
	
	subtract_from_variable = { trainers_available = planes_lost }
}
air_plan_training_pilots_update = {
	set_temp_variable = { gain_pilots = ENG.pilots }
	set_temp_variable = { factor = ENG.pilot_gain_factor }
	add_to_temp_variable = { factor = 1 }
	multiply_temp_variable = { gain_pilots = factor }
	
	add_to_variable = { ENG.pilots_available = ENG.pilots tooltip = CW_PLAN_from_ENG }
	if = {
		limit = {
			has_completed_focus = CW_others
		}
		set_temp_variable = { exiled_pilots = exiles^num }
		multiply_temp_variable = { exiled_pilots = 1.1 }
		add_to_variable = { ENG.pilots_available = exiled_pilots tooltip = CW_PLAN_from_exiles }
	}
	
	## Commonwealth participation
	
	if = {
		limit = {
			CAN = { has_country_flag = CW_THE_PLAN }
		}
		set_temp_variable = { gain_pilots = CAN.pilots }
		set_temp_variable = { factor = CAN.pilot_gain_factor }
		add_to_temp_variable = { factor = 1 }
		multiply_temp_variable = { gain_pilots = factor }
		add_to_variable = { ENG.pilots_available = gain_pilots tooltip = CW_PLAN_from_CAN }
	}
	if = {
		limit = {
			AST = { has_country_flag = CW_THE_PLAN }
		}
		set_temp_variable = { gain_pilots = AST.pilots }
		set_temp_variable = { factor = AST.pilot_gain_factor }
		add_to_temp_variable = { factor = 1 }
		multiply_temp_variable = { gain_pilots = factor }
		add_to_variable = { ENG.pilots_available = gain_pilots tooltip = CW_PLAN_from_AST }
	}
	if = {
		limit = {
			NZL = { has_country_flag = CW_THE_PLAN }
		}
		set_temp_variable = { gain_pilots = NZL.pilots }
		set_temp_variable = { factor = NZL.pilot_gain_factor }
		add_to_temp_variable = { factor = 1 }
		multiply_temp_variable = { gain_pilots = factor }
		add_to_variable = { ENG.pilots_available = gain_pilots tooltip = CW_PLAN_from_NZL }
	}
	if = {
		limit = {
			SAF = { has_country_flag = CW_THE_PLAN }
		}
		set_temp_variable = { gain_pilots = SAF.pilots }
		set_temp_variable = { factor = SAF.pilot_gain_factor }
		add_to_temp_variable = { factor = 1 }
		multiply_temp_variable = { gain_pilots = factor }
		add_to_variable = { ENG.pilots_available = gain_pilots tooltip = CW_PLAN_from_SAF }
	}
	if = {
		limit = {
			USA = { has_country_flag = pilots_sent }
		}
		add_to_variable = { ENG.pilots_available = USA.pilots tooltip = CW_PLAN_from_USA }
	}
	
	set_variable = { planes_lost = trainers_available }
	multiply_variable = { planes_lost = PLAN_accident_rate }

	subtract_from_variable = { pilots_available = planes_lost }
}
air_plan_daily_update = {
	set_temp_variable = { temp_pilot = ENG.pilots_available }
	
	set_temp_variable = { training_aircraft_max_capacity = ENG.trainers_available }
	clamp_temp_variable = {
		var = training_aircraft_max_capacity
		max = ENG.training_bases #check we have enough training centers to train at
	}
	set_temp_variable = { aircraft_clamped = training_aircraft_max_capacity }
	multiply_temp_variable = { training_aircraft_max_capacity = 10 }
	clamp_temp_variable = {
		var = temp_pilot
		max = training_aircraft_max_capacity #check we have enough planes to train with
	}
	custom_effect_tooltip = CW_DAILY_TRAINEES
	custom_effect_tooltip = CW_DAILY_AIRCRAFT
	
	#multiply_temp_variable = { temp_pilot = 10 } #back to pilots
	
	divide_temp_variable = { temp_pilot = ENG.PLAN_training_time } #assuming average of 12 week course
	add_to_variable = { pilots_trained = temp_pilot } #add the temp pilots
	subtract_from_variable = { pilots_available = temp_pilot }
	set_variable = { pilots_daily = temp_pilot }
	custom_effect_tooltip = CW_DAILY_TIME
}
air_plan_effect_update = {
	air_plan_production_update = yes
	air_plan_training_pilots_update = yes
	air_plan_training_aircraft_update = yes
	if = {
		limit = {
			NOT = { has_idea = CW_british_commonwealth_air_training_plan }
			check_variable = { pilots_trained > PLAN_level_1 }
		}
		every_country = {
			limit = {
				has_idea = CW_british_commonwealth_air_training_plan
			}
			swap_ideas = {
				remove_idea = CW_british_commonwealth_air_training_plan
				add_idea = CW_british_commonwealth_air_training_plan2
			}
		}
	}
	else_if = {
		limit = {
			has_idea = CW_british_commonwealth_air_training_plan
			check_variable = { pilots_trained > PLAN_level_2 }
		}
		every_country = {
			limit = {
				has_idea = CW_british_commonwealth_air_training_plan
			}
			swap_ideas = {
				remove_idea = CW_british_commonwealth_air_training_plan
				add_idea = CW_british_commonwealth_air_training_plan2
			}
		}
	}
	else_if = {
		limit = {
			has_idea = CW_british_commonwealth_air_training_plan2
			check_variable = { pilots_trained > PLAN_level_3 }
		}
		every_country = {
			limit = {
				has_idea = CW_british_commonwealth_air_training_plan2
			}
			swap_ideas = {
				remove_idea = CW_british_commonwealth_air_training_plan2
				add_idea = CW_british_commonwealth_air_training_plan3
			}
		}
	}
	else_if = {
		limit = {
			has_idea = CW_british_commonwealth_air_training_plan3
			check_variable = { pilots_trained > PLAN_level_4 }
		}
		every_country = {
			limit = {
				has_idea = CW_british_commonwealth_air_training_plan3
			}
			swap_ideas = {
				remove_idea = CW_british_commonwealth_air_training_plan3
				add_idea = CW_british_commonwealth_air_training_plan4
			}
		}
	}
	else_if = {
		limit = {
			has_idea = CW_british_commonwealth_air_training_plan4
			check_variable = { pilots_trained > PLAN_level_5 }
		}
		every_country = {
			limit = {
				has_idea = CW_british_commonwealth_air_training_plan4
			}
			swap_ideas = {
				remove_idea = CW_british_commonwealth_air_training_plan4
				add_idea = CW_british_commonwealth_air_training_plan5
			}
		}
	}
	else_if = {
		limit = {
			has_idea = CW_british_commonwealth_air_training_plan5
			check_variable = { pilots_trained > PLAN_level_6 }
		}
		every_country = {
			limit = {
				has_idea = CW_british_commonwealth_air_training_plan5
			}
			swap_ideas = {
				remove_idea = CW_british_commonwealth_air_training_plan5
				add_idea = CW_british_commonwealth_air_training_plan6
			}
		}
	}
	
}
air_plan_progress_ratio_update = {
	## Calculate progress % 
	if = {
		limit = {
			NOT = { check_variable = { CW_plan_progress = 100 } }
		}
			
		if = {
			limit = {
				check_variable = { PLAN_level_1 > pilots_trained }
			}
			set_temp_variable = { progress = pilots_trained }
			divide_temp_variable = { progress = PLAN_level_1 }
			multiply_temp_variable = { progress = 100 }
			divide_temp_variable = { progress = 6 }
		}
		else_if = {
			limit = {
				check_variable = { PLAN_level_2 > pilots_trained }
			}
			set_temp_variable = { progress = pilots_trained }
			subtract_from_temp_variable = { progress = PLAN_level_1 }
			set_temp_variable = { divisor = PLAN_level_2 }
			subtract_from_temp_variable = { divisor = PLAN_level_1 }
			divide_temp_variable = { progress = divisor }
			multiply_temp_variable = { progress = 100 }
			divide_temp_variable = { progress = 6 }
			add_to_temp_variable = { progress = 16.666 }
		}
		else_if = {
			limit = {
				check_variable = { PLAN_level_3 > pilots_trained }
			}
			set_temp_variable = { progress = pilots_trained }
			subtract_from_temp_variable = { progress = PLAN_level_2 }
			set_temp_variable = { divisor = PLAN_level_3 }
			subtract_from_temp_variable = { divisor = PLAN_level_2 }
			divide_temp_variable = { progress = divisor }
			multiply_temp_variable = { progress = 100 }
			divide_temp_variable = { progress = 6 }
			add_to_temp_variable = { progress = 33.332 }
		}
		else_if = {
			limit = {
				check_variable = { PLAN_level_4 > pilots_trained }
			}
			set_temp_variable = { progress = pilots_trained }
			subtract_from_temp_variable = { progress = PLAN_level_3 }
			set_temp_variable = { divisor = PLAN_level_4 }
			subtract_from_temp_variable = { divisor = PLAN_level_3 }
			divide_temp_variable = { progress = divisor }
			multiply_temp_variable = { progress = 100 }
			divide_temp_variable = { progress = 6 }
			add_to_temp_variable = { progress = 49.998 }
		}
		else_if = {
			limit = {
				check_variable = { PLAN_level_5 > pilots_trained }
			}
			set_temp_variable = { progress = pilots_trained }
			subtract_from_temp_variable = { progress = PLAN_level_4 }
			set_temp_variable = { divisor = PLAN_level_5 }
			subtract_from_temp_variable = { divisor = PLAN_level_4 }
			divide_temp_variable = { progress = divisor }
			multiply_temp_variable = { progress = 100 }
			divide_temp_variable = { progress = 6 }
			add_to_temp_variable = { progress = 66.664 }
		}
		else_if = {
			limit = {
				check_variable = { PLAN_level_6 > pilots_trained }
			}
			set_temp_variable = { progress = pilots_trained }
			subtract_from_temp_variable = { progress = PLAN_level_5 }
			set_temp_variable = { divisor = PLAN_level_6 }
			subtract_from_temp_variable = { divisor = PLAN_level_5 }
			divide_temp_variable = { progress = divisor }
			multiply_temp_variable = { progress = 100 }
			divide_temp_variable = { progress = 6 }
			add_to_temp_variable = { progress = 83.330 }
		}
		else = {
			set_temp_variable = { progress = 100 }
		}
		set_variable = { CW_plan_progress = progress }
	}
}
overlord_start = {
	14 = {
		add_dynamic_modifier = {
			modifier = CW_overlord_state
			days = 14
		}		
	}
	15 = {
		add_dynamic_modifier = {
			modifier = CW_overlord_state
			days = 14
		}		
	}
	886 = {
		add_dynamic_modifier = {
			modifier = CW_overlord_state
			days = 14
		}		
	}
	29 = {
		add_dynamic_modifier = {
			modifier = CW_overlord_state
			days = 14
		}		
	}
	6 = {
		add_dynamic_modifier = {
			modifier = CW_overlord_state
			days = 14
		}		
	}
	7 = {
		add_dynamic_modifier = {
			modifier = CW_overlord_state
			days = 14
		}		
	}
	if = {
		limit = {
			ENG = {
				has_completed_focus = CW_sea_barrage
			}
		}
		14 = {
			damage_building = {
				type = coastal_bunker
				damage = 3
			}	
		}
		15 = {
			damage_building = {
				type = coastal_bunker
				damage = 3
			}		
		}
		886 = {
			damage_building = {
				type = coastal_bunker
				damage = 3
			}		
		}
		29 = {
			damage_building = {
				type = coastal_bunker
				damage = 3
			}	
		}
		6 = {
			damage_building = {
				type = coastal_bunker
				damage = 3
			}		
		}
		7 = {
			damage_building = {
				type = coastal_bunker
				damage = 3
			}	
		}
	}
	if = {
		limit = {
			ENG = {
				has_completed_focus = CW_dropsites
			}
		}
		if = {
			limit = {
				ENG = {
					 not = { has_completed_focus = CW_gliders }
				}
			}
			division_template = {
				name = "Airborne"
				template_counter = 3011
				priority = 2
				
				regiments = {
					paratrooper = { x = 0 y = 0 }
					paratrooper = { x = 0 y = 1 }
					paratrooper = { x = 0 y = 2 }
				}
				support = {
					DIV_HQ_airborne = { x = 0 y = 0 }
				}
			}
			15 = {
				create_unit = {
					division = "name = \"3rd Para Brigade\" division_template = \"Airborne\" start_experience_factor = 0.75 start_equipment_factor = 1"
					owner = ENG
					allow_spawning_on_enemy_provs = yes
				}
				create_unit = {
					division = "name = \"6th Airlanding Brigade\" division_template = \"Airborne\" start_experience_factor = 0.75 start_equipment_factor = 1"
					owner = ENG
					allow_spawning_on_enemy_provs = yes
				}
			}
			886 = {
				create_unit = {
					division = "name = \"5th Para Brigade\" division_template = \"Airborne\" start_experience_factor = 0.75 start_equipment_factor = 1"
					owner = ENG
					allow_spawning_on_enemy_provs = yes
				}
			}			
			#basic parra's
			if = {
				limit = {
					USA = {
						is_in_faction_with = ENG
					}
				}
				division_template = {
					name = "Airborne"
					template_counter = 3011
					priority = 2
					
					regiments = {
						paratrooper = { x = 0 y = 0 }
						paratrooper = { x = 0 y = 1 }
						paratrooper = { x = 0 y = 2 }
					}
					support = {
						DIV_HQ_airborne = { x = 0 y = 0 }
					}
				}

				30 = {
					create_unit = {
						division = "name = \"Airborne\" division_template = \"Airborne\" start_experience_factor = 0.75"
						owner = USA
						allow_spawning_on_enemy_provs = yes
					}
					create_unit = {
						division = "name = \"Airborne\" division_template = \"Airborne\" start_experience_factor = 0.75"
						owner = USA
						allow_spawning_on_enemy_provs = yes
					}
				}
			}
		}
		else = {
			division_template = {
				name = "Airborne"
				template_counter = 3011
				priority = 2
				
				regiments = {
					paratrooper = { x = 0 y = 0 }
					paratrooper = { x = 0 y = 1 }
					paratrooper = { x = 0 y = 2 }
					
					artillery_brigade = { x = 1 y = 0 }	
					artillery_brigade = { x = 1 y = 1 }
					anti_tank_brigade = { x = 1 y = 2 }				
					
				}
				support = {
					DIV_HQ_airborne = { x = 0 y = 0 }
					field_hospital = { x = 0 y = 1 }
					engineer = { x = 0 y = 2 }
				}
			}
			15 = {
				create_unit = {
					division = "name = \"3rd Para Brigade\" division_template = \"Airborne\" start_experience_factor = 0.75 start_equipment_factor = 1"
					owner = ENG
					allow_spawning_on_enemy_provs = yes
				}
				create_unit = {
					division = "name = \"6th Airlanding Brigade\" division_template = \"Airborne\" start_experience_factor = 0.75 start_equipment_factor = 1"
					owner = ENG
					allow_spawning_on_enemy_provs = yes
				}
			}
			886 = {
				create_unit = {
					division = "name = \"5th Para Brigade\" division_template = \"Airborne\" start_experience_factor = 0.75 start_equipment_factor = 1"
					owner = ENG
					allow_spawning_on_enemy_provs = yes
				}
			}

			if = {
				limit = {
					USA = {
						is_in_faction_with = ENG
					}
				}
				division_template = {
					name = "Airborne"
					template_counter = 3011
					priority = 2
					
					regiments = {
						paratrooper = { x = 0 y = 0 }
						paratrooper = { x = 0 y = 1 }
						paratrooper = { x = 0 y = 2 }
						
						artillery_brigade = { x = 1 y = 0 }	
						artillery_brigade = { x = 1 y = 1 }
						anti_tank_brigade = { x = 1 y = 2 }				
						
					}
					support = {
						DIV_HQ_airborne = { x = 0 y = 0 }
						field_hospital = { x = 0 y = 1 }
						engineer = { x = 0 y = 2 }
					}
				}
				30 = {
					create_unit = {
						division = "name = \"Airborne\" division_template = \"Airborne\" start_experience_factor = 0.75 start_equipment_factor = 1"
						owner = USA
						allow_spawning_on_enemy_provs = yes
					}
					create_unit = {
						division = "name = \"Airborne\" division_template = \"Airborne\" start_experience_factor = 0.75 start_equipment_factor = 1"
						owner = USA
						allow_spawning_on_enemy_provs = yes
					}
				}
			}
		}
	}
	if = {
		limit = {
			ENG = {
				has_completed_focus = CW_deception
			}
		}
		GER = {
			every_controlled_state = {
				limit = {
					OR = {
						is_core_of = FRA
						is_core_of = BEL
						is_core_of = DEN
					}
				}
				add_state_modifier = {
					modifier = {
						disable_strategic_redeployment = 1
					}
				}
			}
			country_event = { id = blackiceevents.7 days = 7 }
		}
	}	
	for_each_scope_loop = {
		array = FRA.core_states 
		if = {
			limit = {
				is_controlled_by = GER
				is_in_home_area = yes
			}
			add_to_variable = { resist_help = resistance }
		}
	}
	FRA = {
		set_technology = {
			partisans = 1
			popup = no
		}
		division_template = {
			name = "Maquis"			

			regiments = {
				militia = { x = 0 y = 0 }
				partisan = { x = 0 y = 1 }
				partisan = { x = 0 y = 2 }
			}
		}
		32 = {
			create_unit = {
				division = "name = \"Maquis\" division_template = \"Maquis\" start_experience_factor = 0.35 start_equipment_factor = 1"
				owner = FRA
				allow_spawning_on_enemy_provs = yes
				count = 2
				prioritize_location = 3768
			}
		}
		if = {
			limit = {
				has_country_flag = uprising
			}
			
			while_loop_effect = {
				limit = {
					check_variable = { resist_help > 0 }
				}
				FRA = {
					random_core_state = {
						limit = {
							is_controlled_by = GER
							is_in_home_area = yes
						}
						create_unit = {
							division = "name = \"Maquis\" division_template = \"Maquis\" start_experience_factor = 0.25 start_equipment_factor = 1"
							owner = FRA
							allow_spawning_on_enemy_provs = yes
						}						
					}
					add_to_variable = { resist_help = -1 }
				}
			}
			clr_country_flag = uprising
		}	
		else = {
			while_loop_effect = {
				limit = {
					check_variable = { resist_help > 0 }
				}
				FRA = {
					random_core_state = {
						limit = {
							is_controlled_by = GER
							is_in_home_area = yes
							non_damaged_building_level = {
								building = infrastructure
								level > 1
							}
						}
						damage_building = {
							type = infrastructure
							damage = 1
						}
						damage_building = {
							type = rail_way
							damage = 1
						}
					}
				}
				add_to_variable = { resist_help = -0.25 }
			}
		}
		
	}
	SOV = {
		set_country_flag = overlord_start
	}
}