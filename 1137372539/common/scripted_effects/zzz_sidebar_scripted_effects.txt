
sidebar_on_startup = {
	set_country_flag = sidebar
	
	if = {
		limit = { 
			OR = {
				has_idea = incompetent_industry_real
				has_idea = incompetent_industry_real_2
				has_idea = incompetent_industry_real_3
				has_idea = incompetent_industry_real_4
				has_idea = incompetent_industry_real_5
			}
		}
		add_to_array = { sidebar_list = token:incompetent_industry_real }
	}
	if = {
		limit = { 
			OR = {
				has_idea = incompetent_industry_real_navy
				has_idea = incompetent_industry_real_2_navy
				has_idea = incompetent_industry_real_3_navy
				has_idea = incompetent_industry_real_4_navy
				has_idea = incompetent_industry_real_5_navy
			}
		}
		add_to_array = { sidebar_list = token:incompetent_industry_real_navy }
	}
	if = {
		limit = { 
			OR = {
				has_idea = CHI_army_corruption_1
				has_idea = CHI_army_corruption_2
				has_idea = CHI_army_corruption_3
				has_idea = CHI_army_corruption_4
			}
		}
		add_to_array = { sidebar_list = token:CHI_army_corruption_1 }
	}
	if = {
		limit = { 
			OR = {
				has_idea = KMT_weak_army
				has_idea = KMT_weak_army_lesser
				has_idea = KMT_weak_army_lesserer
			}
		}
		add_to_array = { sidebar_list = token:KMT_weak_army }
	}
	
	if = {
		limit = { 
			OR = {
				has_idea = CW_great_depression_0
				has_idea = CW_great_depression_1
				has_idea = CW_great_depression_2
				has_idea = CW_great_depression_3
				has_idea = CW_great_depression_4
				has_idea = CW_great_depression_5
				has_idea = CW_great_depression_6
			}
		}
		add_to_array = { sidebar_list = token:CW_great_depression_0 }
	}
	
	if = {
		limit = {
			tag = USA
		}
		add_to_array = { sidebar_list = token:USA_island_hopping1 }
		add_to_array = { sidebar_list = token:dust_bowl_idea }
		add_to_array = { sidebar_list = token:great_depression }
	}
	
	if = {
		limit = {
			tag = JAP
		}
		add_to_array = { sidebar_list = token:JAP_island_hopping1 }
	}
	
	if = {
		limit = {
			tag = GER
		}
		add_to_array = { sidebar_list = token:GER_mefo_bills_1 }
	}
	
	if = {
		limit = {
			tag = FRA
		}
		add_to_array = { sidebar_list = token:FRA_stagnant_econ_1 }
		add_to_array = { sidebar_list = token:FRA_victors_of_wwi_1 }
	}
	
	if = {
		limit = {
			tag = ENG
		}
		add_to_array = { sidebar_list = token:ENG_the_colonies }
	}
}

sidebar_entry_tooltip = {
	if = {
		limit = {
			check_variable = { evaluate_token = token:topbar_army_strength }
		}
		army_strength_tooltip = yes
	}
	else_if = {
		limit = {
			check_variable = { evaluate_token = token:topbar_air_strength }
		}
		air_strength_tooltip = yes
	}
	else_if = {
		limit = {
			check_variable = { evaluate_token = token:topbar_navy_strength }
		}
		navy_strength_tooltip = yes
	}
}

sidebar_effect = {
	
	if = {
		limit = { # enter values in here to have the tooltip display a scripted effect instead of the idea
			OR = {
				check_variable = { v = token:officers_purged }
				check_variable = { v = token:red_army_purged }
				check_variable = { v = token:red_air_purged }
				check_variable = { v = token:red_fleet_purged }
				check_variable = { v = token:USA_island_hopping1 }
				check_variable = { v = token:JAP_island_hopping1 }
				check_variable = { v = token:ENG_the_colonies }
			}
		}
		meta_effect = {
			text = {
				ui_[X] = yes
			}
			X = "[?v.GetTokenKey]"
		}
	}
	else_if = {
		limit = {
			check_variable = { invalid = 1 }
		}
		
		custom_effect_tooltip = SIDEBAR_ENTRY_REMOVED_SOON
		add_to_temp_array = { invalid_sidebar = v }
	}
	else = {
		meta_effect = {
			text = {
				show_ideas_tooltip = [X]
			}
			X = "[?icon.GetTokenKey]"
		}
	}
}

sidebar_remove_invalid = {
	for_each_loop = {
		array = sidebar_list
		
		if = {
			limit = {
				sidebar_trigger = yes
			}
			sidebar_effect = yes
		}
	}
	
	for_each_loop = {
		array = invalid_sidebar
		
		remove_from_array = { sidebar_list = v }
	}
}

#################################################

ui_officers_purged = {
	custom_effect_tooltip = {
		localization_key = SIDEBAR_TITLE
		TITLE = officers_purged
	}
	
	add_to_temp_variable = { t = officers_purged_train tooltip = officers_purged_train_TT }
	add_to_temp_variable = { t = officers_purged_mobilization tooltip = officers_purged_mobilization_TT }
	add_to_temp_variable = { t = officers_purged_command tooltip = officers_purged_command_TT }
	add_to_temp_variable = { t = officers_purged_experience tooltip = officers_purged_experience_TT }
	add_to_temp_variable = { t = officers_purged_experience_cap tooltip = officers_purged_experience_cap_TT }
	add_to_temp_variable = { t = 2.5 tooltip = officers_purged_military_leader_cost_factor_TT }
	add_to_temp_variable = { t = army_purge_doctrine tooltip = army_purge_doctrine_TT }
}

ui_red_army_purged = {
	custom_effect_tooltip = {
		localization_key = SIDEBAR_TITLE
		TITLE = red_army_purged
	}
	
	if = {
		limit = {
			has_dynamic_modifier = {
				modifier = red_army_purged
			}
		}
		add_to_temp_variable = { t = army_purge_defence tooltip = army_purge_defence_TT }
		add_to_temp_variable = { t = army_purge_org tooltip = army_purge_org_TT }
		add_to_temp_variable = { t = army_purge_morale tooltip = army_purge_morale_TT }
		add_to_temp_variable = { t = army_purge_breakthough tooltip = army_purge_breakthough_TT }
		add_to_temp_variable = { t = army_purge_width tooltip = army_purge_width_TT }
		add_to_temp_variable = { t = army_purge_attrition tooltip = army_purge_attrition_TT }
		add_to_temp_variable = { t = army_purge_tank_defense tooltip = army_purge_tank_defense_TT }
		
	}
	else = {
		custom_effect_tooltip = army_purge_active_at_war
		effect_tooltip = {
			SOV_initiate_red_purge_values = yes
		}
	}
	
	custom_effect_tooltip = purge_passive_decay
}

ui_red_air_purged = {
	custom_effect_tooltip = {
		localization_key = SIDEBAR_TITLE
		TITLE = red_air_purged
	}
	
	add_to_temp_variable = { t = air_purge_xp tooltip = air_purge_xp_TT }
	add_to_temp_variable = { t = air_purge_xp_max tooltip = air_purge_xp_max_TT }
	add_to_temp_variable = { t = air_purge_sup tooltip = air_purge_sup_TT }
	add_to_temp_variable = { t = air_purge_cas tooltip = air_purge_cas_TT }
	add_to_temp_variable = { t = air_purge_strat tooltip = air_purge_strat_TT }
	add_to_temp_variable = { t = air_purge_escort tooltip = air_purge_escort_TT }
	add_to_temp_variable = { t = air_purge_intercept tooltip = air_purge_intercept_TT }
	add_to_temp_variable = { t = air_purge_nav tooltip = air_purge_nav_TT }
	add_to_temp_variable = { t = air_purge_ace tooltip = air_purge_ace_TT }
	add_to_temp_variable = { t = air_purge_accident tooltip = air_purge_accident_TT }
	add_to_temp_variable = { t = air_purge_doctrine tooltip = air_purge_doctrine_TT }
		
	custom_effect_tooltip = purge_passive_decay
}

ui_red_fleet_purged = {
	custom_effect_tooltip = {
		localization_key = SIDEBAR_TITLE
		TITLE = red_fleet_purged
	}
	
	add_to_temp_variable = { t = nav_purge_xp tooltip = nav_purge_xp_TT }
	add_to_temp_variable = { t = nav_purge_convoy tooltip = nav_purge_convoy_TT }
	add_to_temp_variable = { t = nav_purge_accident tooltip = nav_purge_accident_TT }
	add_to_temp_variable = { t = nav_purge_caps tooltip = nav_purge_caps_TT }
	add_to_temp_variable = { t = nav_purge_sub tooltip = nav_purge_sub_TT }
	add_to_temp_variable = { t = nav_purge_sortie tooltip = nav_purge_sortie_TT }
	add_to_temp_variable = { t = nav_purge_air tooltip = nav_purge_air_TT }
	add_to_temp_variable = { t = nav_purge_org tooltip = nav_purge_org_TT }
	add_to_temp_variable = { t = nav_purge_hit tooltip = nav_purge_hit_TT }
	add_to_temp_variable = { t = nav_purge_strike tooltip = nav_purge_strike_TT }
	add_to_temp_variable = { t = nav_purge_retreat tooltip = nav_purge_retreat_TT }
	add_to_temp_variable = { t = nav_purge_screen tooltip = nav_purge_screen_TT }

	custom_effect_tooltip = purge_passive_decay
}

ui_JAP_island_hopping1 = {

	meta_effect = {
		text = {
			show_ideas_tooltip = [X]
		}
		X = "[?icon.GetTokenKey]"
	}
	custom_effect_tooltip = island_hopping_desc
}

ui_USA_island_hopping1 = {

	meta_effect = {
		text = {
			show_ideas_tooltip = [X]
		}
		X = "[?icon.GetTokenKey]"
	}
	custom_effect_tooltip = island_hopping_desc
}

ui_ENG_the_colonies = {

	custom_effect_tooltip = {
		localization_key = SIDEBAR_TITLE
		TITLE = ENG_the_colonies
	}
	
	set_temp_variable = { t = british_political_cost tooltip = british_political_cost_tt }
	set_temp_variable = { t = british_trade_factor tooltip = british_trade_factor_tt }
	set_temp_variable = { t = british_consumer_goods tooltip = british_consumer_goods_tt }
	set_temp_variable = { t = british_stability tooltip = british_stability_tt }
	custom_effect_tooltip = generic_skip_one_line_tt
	custom_effect_tooltip = ENG_the_colonies_desc
}
